<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ­¡ä¿®è¡Œæ‰­è›‹æ©Ÿ - é‡å­ç‰ˆ</title>
    <style>
        :root {
            --glow-purple: #da00ff;
            --glow-cyan: #00e0ff;
            --background-color: #0d0c1d;
            --grid-color: rgba(218, 0, 255, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            min-height: 100vh;
            background-color: var(--background-color);
            color: #fff;
            display: flex;
            justify-content: center;
            align-items: center;
            font-family: 'Noto Sans TC', 'Microsoft JhengHei', sans-serif;
            padding: 20px;
            overflow: hidden;
            position: relative;
        }

        /* èƒŒæ™¯ç¶²æ ¼ */
        .grid-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image:
                linear-gradient(var(--grid-color) 1px, transparent 1px),
                linear-gradient(90deg, var(--grid-color) 1px, transparent 1px);
            background-size: 40px 40px;
            animation: grid-pan 8s linear infinite;
            pointer-events: none;
        }

        @keyframes grid-pan {
            0% { background-position: 0 0; }
            100% { background-position: 40px 40px; }
        }

        /* ä¸»å®¹å™¨ï¼Œç¢ºä¿æ‰€æœ‰å…§å®¹å‚ç›´æ’åˆ—ä¸”å¯è¦‹ */
        .main-container {
            position: relative;
            z-index: 10;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 40px; /* èª¿æ•´å…ƒç´ ä¹‹é–“çš„é–“è· */
            width: 100%;
            max-width: 450px;
        }

        /* æ¨™é¡Œå€ */
        .header-section {
            text-align: center;
        }

        .main-title {
            font-size: clamp(28px, 6vw, 36px);
            font-weight: 700;
            color: #f0f0f0;
            text-shadow: 0 0 10px var(--glow-purple), 0 0 20px var(--glow-purple);
            margin-bottom: 8px;
        }

        .main-title .sparkle {
            color: var(--glow-cyan);
            text-shadow: 0 0 10px var(--glow-cyan);
            display: inline-block;
            animation: sparkle-anim 2s infinite;
        }
        
        @keyframes sparkle-anim {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.3); opacity: 0.7; }
        }

        .subtitle {
            font-size: clamp(14px, 3vw, 16px);
            color: #a9a9b3;
        }

        /* æ‰­è›‹é¡¯ç¤ºå€ */
        .capsule-display {
            width: 280px;
            height: 280px;
            position: relative;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* å¤–éƒ¨å…‰ç’° */
        .rings {
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 50%;
        }

        .rings::before, .rings::after {
            content: '';
            position: absolute;
            border-radius: 50%;
            inset: 0;
            animation: rotate 10s linear infinite;
        }

        .rings::before {
            box-shadow: 0 0 20px var(--glow-purple);
            border: 2px solid var(--glow-purple);
            inset: -10px;
        }

        .rings::after {
            box-shadow: 0 0 20px var(--glow-cyan);
            border: 2px solid var(--glow-cyan);
            animation-direction: reverse;
            animation-duration: 8s;
        }

        @keyframes rotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* å…§éƒ¨çƒé«” */
        .sphere {
            width: 220px;
            height: 220px;
            border-radius: 50%;
            background: radial-gradient(circle at 30% 30%, rgba(0, 255, 255, 0.2), transparent 70%);
            border: 1px solid rgba(0, 255, 255, 0.3);
            transform-style: preserve-3d;
            display: flex;
            justify-content: center;
            align-items: center;
            animation: sphere-rotate 25s linear infinite;
        }
        
        @keyframes sphere-rotate {
             0% { transform: rotateY(0deg) rotateX(10deg); }
            100% { transform: rotateY(360deg) rotateX(10deg); }
        }


        /* 3D æ–¹å¡Š */
        .cube {
            position: absolute;
            width: 40px;
            height: 40px;
            transform-style: preserve-3d;
        }

        .cube .face {
            position: absolute;
            width: 100%;
            height: 100%;
            border: 1px solid rgba(255, 255, 255, 0.7);
            background: radial-gradient(rgba(255, 255, 255, 0.2), transparent);
        }

        .cube .face:nth-child(1) { transform: translateZ(20px); }
        .cube .face:nth-child(2) { transform: rotateY(180deg) translateZ(20px); }
        .cube .face:nth-child(3) { transform: rotateY(90deg) translateZ(20px); }
        .cube .face:nth-child(4) { transform: rotateY(-90deg) translateZ(20px); }
        .cube .face:nth-child(5) { transform: rotateX(90deg) translateZ(20px); }
        .cube .face:nth-child(6) { transform: rotateX(-90deg) translateZ(20px); }
        
        /* [ä¿®æ”¹] å¢åŠ åˆ° 6 å€‹æ–¹å¡Š */
        .cube-1 { animation: float 6s ease-in-out infinite; }
        .cube-2 { animation: float 8s ease-in-out infinite 1s; }
        .cube-3 { animation: float 7s ease-in-out infinite 0.5s; }
        .cube-4 { animation: float 9s ease-in-out infinite 1.5s; }
        .cube-5 { animation: float 5s ease-in-out infinite 0.2s; }
        .cube-6 { animation: float 8.5s ease-in-out infinite 1.2s; }

        @keyframes float {
            0%, 100% { transform: var(--transform-start); }
            50% { transform: var(--transform-end); }
        }

        .cube-1 { --transform-start: translateX(-50px) translateY(-20px) translateZ(20px) rotateY(45deg); --transform-end: translateX(-40px) translateY(-30px) translateZ(10px) rotateY(65deg); }
        .cube-2 { --transform-start: translateX(40px) translateY(30px) translateZ(-10px) rotateY(20deg); --transform-end: translateX(50px) translateY(20px) translateZ(0px) rotateY(0deg); }
        .cube-3 { --transform-start: translateX(10px) translateY(-40px) translateZ(0px) rotateY(-30deg); --transform-end: translateX(0px) translateY(-50px) translateZ(-10px) rotateY(-50deg); }
        .cube-4 { --transform-start: translateX(60px) translateY(-30px) translateZ(15px) rotateY(120deg); --transform-end: translateX(50px) translateY(-40px) translateZ(5px) rotateY(140deg); }
        .cube-5 { --transform-start: translateX(-60px) translateY(40px) translateZ(-5px) rotateY(-60deg); --transform-end: translateX(-70px) translateY(30px) translateZ(-15px) rotateY(-80deg); }
        .cube-6 { --transform-start: translateX(0px) translateY(50px) translateZ(25px) rotateY(90deg); --transform-end: translateX(10px) translateY(60px) translateZ(15px) rotateY(110deg); }


        /* æŒ‰éˆ•å€ */
        .button-container {
            width: 280px;
            height: 80px;
            padding: 10px;
            border: 2px solid var(--glow-purple);
            border-radius: 20px;
            background: rgba(240, 0, 240, 0.05);
            box-shadow: 0 0 20px rgba(240, 0, 240, 0.2);
        }

        .action-button {
            width: 100%;
            height: 100%;
            border: none;
            border-radius: 15px;
            background: linear-gradient(45deg, var(--glow-purple), var(--glow-cyan));
            color: white;
            font-size: 20px;
            font-weight: bold;
            letter-spacing: 2px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.5);
        }

        .action-button:hover {
            transform: scale(1.05);
            box-shadow: 0 0 30px rgba(0, 255, 255, 0.8);
        }

        .action-button:active {
            transform: scale(1);
            filter: brightness(0.9);
        }
        
        /* Modal æ¨£å¼ */
        .cyber-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            --modal-color: #ff00ff;
        }

        .cyber-modal.show {
            display: flex;
            animation: modal-fade 0.3s ease-out;
        }

        @keyframes modal-fade { from { opacity: 0; } to { opacity: 1; } }

        .modal-content {
            background: linear-gradient(135deg, #1a0033, #0a1628);
            border: 2px solid var(--modal-color);
            border-radius: 20px;
            padding: 40px;
            max-width: 500px;
            width: 90%;
            position: relative;
            box-shadow: 0 0 50px var(--modal-color), inset 0 0 30px rgba(0, 255, 255, 0.2);
        }

        .modal-title {
            font-size: 28px;
            color: var(--modal-color);
            margin-bottom: 20px;
            text-align: center;
            text-shadow: 0 0 20px var(--modal-color);
        }

        .modal-message {
            color: rgba(255, 255, 255, 0.9);
            line-height: 1.8;
            font-size: 16px;
            padding: 20px;
            background: rgba(0,0,0, 0.2);
            border-radius: 10px;
            border-left: 3px solid var(--modal-color);
        }

        .close-button {
            background: var(--modal-color);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            margin-top: 20px;
            letter-spacing: 2px;
            transition: all 0.3s;
            width: 100%;
            box-shadow: 0 0 20px var(--modal-color);
        }

    </style>
</head>
<body>
    <div class="grid-background"></div>
    <div class="main-container">

        <div class="header-section">
            <h1 class="main-title"><span class="sparkle">âœ¦</span> æ­¡ä¿®è¡Œæ‰­è›‹æ©Ÿ <span class="sparkle">âœ¦</span></h1>
            <p class="subtitle">ä»Šå¤©è«‹ä¾æ“šæ­¤åè¨€ä¾†åŠªåŠ›,é‚å‡ºå¤§ä¹˜åˆ©ä»–çš„æ­¥ä¼!</p>
        </div>

        <div class="capsule-display">
            <div class="rings"></div>
            <div class="sphere">
                <!-- [ä¿®æ”¹] å¢åŠ åˆ° 6 å€‹æ–¹å¡Š -->
                <div class="cube cube-1"><div class="face"></div><div class="face"></div><div class="face"></div><div class="face"></div><div class="face"></div><div class="face"></div></div>
                <div class="cube cube-2"><div class="face"></div><div class="face"></div><div class="face"></div><div class="face"></div><div class="face"></div><div class="face"></div></div>
                <div class="cube cube-3"><div class="face"></div><div class="face"></div><div class="face"></div><div class="face"></div><div class="face"></div><div class="face"></div></div>
                <div class="cube cube-4"><div class="face"></div><div class="face"></div><div class="face"></div><div class="face"></div><div class="face"></div><div class="face"></div></div>
                <div class="cube cube-5"><div class="face"></div><div class="face"></div><div class="face"></div><div class="face"></div><div class="face"></div><div class="face"></div></div>
                <div class="cube cube-6"><div class="face"></div><div class="face"></div><div class="face"></div><div class="face"></div><div class="face"></div><div class="face"></div></div>
            </div>
        </div>

        <div class="button-container">
            <button class="action-button" id="actionButton">è«‹æŒ‰æˆ‘</button>
        </div>

        <!-- [å·²ç§»é™¤] åŸæœ¬çš„ç´…è‰²æ–¹æ¡†ç©ºé–“ -->

    </div>

    <div class="cyber-modal" id="cyberModal">
        <div class="modal-content">
            <h3 class="modal-title" id="modalTitle">ğŸ“¿ å¤§ä¹˜ä¹‹é“</h3>
            <div class="modal-message" id="modalMessage">æ­£åœ¨é€£æ¥...</div>
            <button class="close-button" id="closeModalBtn">å—ç„¡çœŸå¦‚</button>
        </div>
    </div>
    
    <script>
        const CSV_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vSmsbivmJSOlSU040kBg0FLr7MglWgV8GFGBpRBuCRah36LH__sp8fgfzHiASonM5d74ysM7qIY9EbL/pub?gid=0&single=true&output=csv';
        
        let mahayanaData = [];
        let isActivated = false;
        let gashaponPool = [];

        function refillGashaponPool() {
            gashaponPool = [1, 2, 3, 4, 5, 6];
        }

        async function loadSheetData() {
            try {
                const response = await fetch(CSV_URL);
                if (!response.ok) throw new Error('Network error');
                const text = await response.text();
                const messages = text.split('\n').slice(1).map(line => line.trim().replace(/^"|"$/g, '')).filter(line => line);
                if (messages.length > 0) {
                    mahayanaData = messages;
                } else {
                    mahayanaData = ["è³‡æ–™åº«é€£ç·šå¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚"];
                }
            } catch (error) {
                console.error('ç„¡æ³•è¼‰å…¥è³‡æ–™:', error);
                mahayanaData = ["è³‡æ–™åº«é€£ç·šå¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚"];
            }
        }
        
        function activateMachine() {
            if (isActivated) return;
            isActivated = true;
            
            const button = document.getElementById('actionButton');
            button.disabled = true;

            // éš¨æ©ŸæŠ½å–
            if (gashaponPool.length === 0) refillGashaponPool();
            const poolIndex = Math.floor(Math.random() * gashaponPool.length);
            const randomNumber = gashaponPool.splice(poolIndex, 1)[0];

            let capsuleColor, bookTitle;
            switch(randomNumber) {
                case 1: bookTitle = 'ç´«è—¤èŠ±ç¬¬ä¸€é›†'; capsuleColor = '#8e44ad'; break;
                case 2: bookTitle = 'ç´«è—¤èŠ±ç¬¬äºŒé›†'; capsuleColor = '#af7ac5'; break;
                case 3: bookTitle = 'ç´«è—¤èŠ±ç¬¬ä¸‰é›†'; capsuleColor = '#fc5c95'; break;
                case 4: bookTitle = 'é€™æ™‚å€™â€§æ·±å‘¼å¸'; capsuleColor = '#3498db'; break;
                case 5: bookTitle = 'çœŸå¦‚äººç”Ÿ'; capsuleColor = '#f39c12'; break;
                case 6: bookTitle = 'çœŸä¹˜ç‰©èª'; capsuleColor = '#2ecc71'; break;
            }

            setTimeout(() => {
                showModal(bookTitle, capsuleColor);
                isActivated = false; 
                button.disabled = false;
            }, 800);
        }
        
        function showModal(title, color) {
            const modal = document.getElementById('cyberModal');
            const modalTitle = document.getElementById('modalTitle');
            const messageEl = document.getElementById('modalMessage');
            
            modalTitle.textContent = `ğŸ“¿ ${title}`;
            modal.style.setProperty('--modal-color', color);
            
            if (mahayanaData.length > 0) {
                const filtered = mahayanaData.filter(m => m.startsWith(`(${title})`));
                if (filtered.length > 0) {
                    const randomMsg = filtered[Math.floor(Math.random() * filtered.length)];
                    messageEl.innerHTML = randomMsg.replace(`(${title})`, '').trim();
                } else {
                    messageEl.innerHTML = `æŠ±æ­‰ï¼Œç›®å‰æ‰¾ä¸åˆ°é—œæ–¼ã€Œ${title}ã€çš„èªéŒ„ã€‚`;
                }
            } else {
                 messageEl.innerHTML = "è¨Šæ¯ç³»çµ±é›¢ç·šï¼Œè«‹ç¨å¾Œå†è©¦ã€‚";
            }
            
            modal.classList.add('show');
        }
        
        function closeModal() {
            const modal = document.getElementById('cyberModal');
            modal.classList.remove('show');
        }
        
        document.addEventListener('DOMContentLoaded', () => {
            loadSheetData();
            refillGashaponPool();
            
            document.getElementById('actionButton').addEventListener('click', activateMachine);
            document.getElementById('closeModalBtn').addEventListener('click', closeModal);
            
            document.getElementById('cyberModal').addEventListener('click', (e) => {
                if (e.target.id === 'cyberModal') {
                    closeModal();
                }
            });
        });
    </script>
</body>
</html>